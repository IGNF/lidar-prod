<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>lidar_prod.tasks &mdash; lidar_prod V1.10.4 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../_static/sphinx_paramlinks.css" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=2f4b31cb"></script>
        <script src="../_static/doctools.js?v=888ff710"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="lidar_prod.commons" href="lidar_prod.commons.html" />
    <link rel="prev" title="lidar_prod.run" href="lidar_prod.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            lidar_prod
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Background</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../background/overview.html">Overview of the process</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../background/overview.html#schema-of-the-overall-process">schema of the overall process</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../background/production_process.html">Production process used to transform point clouds classification</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../background/production_process.html#a-1-vegetation-detection">A.1) Vegetation detection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../background/production_process.html#a-2-unclassified-detection">A.2) Unclassified detection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../background/production_process.html#b-building-module">B) Building Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../background/production_process.html#b-1-building-validation">B.1) Building Validation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../background/production_process.html#b-2-building-completion">B.2) Building Completion</a></li>
<li class="toctree-l2"><a class="reference internal" href="../background/production_process.html#b-3-building-identification">B.3) Building Identification</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../background/thresholds_optimization_process.html">Strategy to find optimal decision thresholds for Building validation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../background/thresholds_optimization_process.html#motivations">Motivations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../background/thresholds_optimization_process.html#strategy">Strategy</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/install.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/install.html#set-up-a-virtual-environment">Set up a virtual environment</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/install.html#install-the-app-as-a-python-module">Install the app as a python module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/install.html#provide-credentials">Provide credentials</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/use.html">Using the app</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/use.html#run-within-a-docker-container">Run within a docker container</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/use.html#run-as-a-python-module">Run as a python module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/use.html#run-from-source-directly">Run from source directly</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/use.html#run-different-tasks">Run Different tasks</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Guides</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../guides/thresholds_optimization.html">How to optimize building validation decision thresholds?</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../guides/thresholds_optimization.html#requirements">Requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/thresholds_optimization.html#running-thresholds-optimization">Running thresholds optimization</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../guides/development.html">Developer’s guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../guides/development.html#code-versionning">Code versionning</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/development.html#tests">Tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/development.html#continuous-integration-ci">Continuous Integration (CI)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/development.html#continuous-delivery-cd">Continuous Delivery (CD)</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Package Reference</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="lidar_prod.html">lidar_prod.run</a><ul>
<li class="toctree-l2"><a class="reference internal" href="lidar_prod.html#lidar_prod.run.POSSIBLE_TASK"><code class="docutils literal notranslate"><span class="pre">POSSIBLE_TASK</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="lidar_prod.html#lidar_prod.run.main"><code class="docutils literal notranslate"><span class="pre">main()</span></code></a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">lidar_prod.tasks</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-lidar_prod.tasks.building_validation">building_validation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-lidar_prod.tasks.building_validation_optimization">building_validation_optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-lidar_prod.tasks.building_completion">building_completion</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-lidar_prod.tasks.building_identification">building_identification</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-lidar_prod.tasks.cleaning">cleaning</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-lidar_prod.tasks.utils">utils</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="lidar_prod.commons.html">lidar_prod.commons</a><ul>
<li class="toctree-l2"><a class="reference internal" href="lidar_prod.commons.html#module-lidar_prod.commons.commons">lidar_prod.commons.commons module</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../configs.html">Default configuration</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">lidar_prod</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">lidar_prod.tasks</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/apidoc/lidar_prod.tasks.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="lidar-prod-tasks">
<h1>lidar_prod.tasks<a class="headerlink" href="#lidar-prod-tasks" title="Link to this heading"></a></h1>
<section id="module-lidar_prod.tasks.building_validation">
<span id="building-validation"></span><h2>building_validation<a class="headerlink" href="#module-lidar_prod.tasks.building_validation" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="lidar_prod.tasks.building_validation.BuildingValidationClusterInfo">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">lidar_prod.tasks.building_validation.</span></span><span class="sig-name descname"><span class="pre">BuildingValidationClusterInfo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">probabilities</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overlays</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">entropies</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/lidar_prod/tasks/building_validation.html#BuildingValidationClusterInfo"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lidar_prod.tasks.building_validation.BuildingValidationClusterInfo" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Elements needed to confirm, refute, or be uncertain about a cluster
of candidate building points.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="lidar_prod.tasks.building_validation.BuildingValidationClusterInfo.entropies">
<span class="sig-name descname"><span class="pre">entropies</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ndarray</span></em><a class="headerlink" href="#lidar_prod.tasks.building_validation.BuildingValidationClusterInfo.entropies" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lidar_prod.tasks.building_validation.BuildingValidationClusterInfo.overlays">
<span class="sig-name descname"><span class="pre">overlays</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ndarray</span></em><a class="headerlink" href="#lidar_prod.tasks.building_validation.BuildingValidationClusterInfo.overlays" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lidar_prod.tasks.building_validation.BuildingValidationClusterInfo.probabilities">
<span class="sig-name descname"><span class="pre">probabilities</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ndarray</span></em><a class="headerlink" href="#lidar_prod.tasks.building_validation.BuildingValidationClusterInfo.probabilities" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lidar_prod.tasks.building_validation.BuildingValidationClusterInfo.target">
<span class="sig-name descname"><span class="pre">target</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#lidar_prod.tasks.building_validation.BuildingValidationClusterInfo.target" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="lidar_prod.tasks.building_validation.BuildingValidator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">lidar_prod.tasks.building_validation.</span></span><span class="sig-name descname"><span class="pre">BuildingValidator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shp_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bd_uni_connection_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cluster</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bd_uni_request</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thresholds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_final_classification_codes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/lidar_prod/tasks/building_validation.html#BuildingValidator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lidar_prod.tasks.building_validation.BuildingValidator" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Logic of building validation.</p>
<p>The candidate building points identified with a rule-based algorithm are cluster together.
The BDUni building vectors are overlayed on the points clouds, and points that fall under
a vector are flagged.
Then, classification dim is updated on a per-group basis, based on both AI probabilities and
BDUni flag.</p>
<p>See <cite>README.md</cite> for the detailed process.</p>
<dl class="py method">
<dt class="sig sig-object py" id="lidar_prod.tasks.building_validation.BuildingValidator.prepare">
<span class="sig-name descname"><span class="pre">prepare</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_values</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Pipeline</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prepared_las_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_result</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">las_metadata</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><span class="pre">dict</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><span class="pre">dict</span></a></span></span><a class="reference internal" href="../_modules/lidar_prod/tasks/building_validation.html#BuildingValidator.prepare"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lidar_prod.tasks.building_validation.BuildingValidator.prepare" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lidar_prod.tasks.building_validation.BuildingValidator.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_values</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Pipeline</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_las_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">las_metadata</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><span class="pre">dict</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><span class="pre">dict</span></a></span></span><a class="reference internal" href="../_modules/lidar_prod/tasks/building_validation.html#BuildingValidator.run"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lidar_prod.tasks.building_validation.BuildingValidator.run" title="Link to this definition"></a></dt>
<dd><p>Runs application.</p>
<p>Transforms cloud at <cite>input_values</cite> following building validation logic,
and saves it to <cite>target_las_path</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><span class="target" id="lidar_prod.tasks.building_validation.BuildingValidator.run.params.input_values"></span><strong>input_values</strong><a class="paramlink headerlink reference internal" href="#lidar_prod.tasks.building_validation.BuildingValidator.run.params.input_values">¶</a> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em>| </em><em>pdal.pipeline.Pipeline</em>) – path or pipeline to input LAS file with</p></li>
<li><p><strong>channel</strong> (<em>a _sphinx_paramlinks_lidar_prod.tasks.building_validation.BuildingValidator.run.building probability</em>) – </p></li>
<li><p><span class="target" id="lidar_prod.tasks.building_validation.BuildingValidator.run.params.target_las_path"></span><strong>target_las_path</strong><a class="paramlink headerlink reference internal" href="#lidar_prod.tasks.building_validation.BuildingValidator.run.params.target_las_path">¶</a> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – path for saving updated LAS file.</p></li>
<li><p><span class="target" id="lidar_prod.tasks.building_validation.BuildingValidator.run.params.las_metadata"></span><strong>las_metadata</strong><a class="paramlink headerlink reference internal" href="#lidar_prod.tasks.building_validation.BuildingValidator.run.params.las_metadata">¶</a> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><em>dict</em></a>) – current pipeline metadata, used to propagate input metadata to the</p></li>
</ul>
</dd>
</dl>
<p>application output las (epsg, las version, etc)</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>returns <cite>las_metadata</cite>: metadata of the input las, which contain
information to pass to the writer in order for the application to have an output
with the same header (las version, srs, …) as the input</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lidar_prod.tasks.building_validation.BuildingValidator.setup">
<span class="sig-name descname"><span class="pre">setup</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/lidar_prod/tasks/building_validation.html#BuildingValidator.setup"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lidar_prod.tasks.building_validation.BuildingValidator.setup" title="Link to this definition"></a></dt>
<dd><p>Setup. Defines useful variables.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lidar_prod.tasks.building_validation.BuildingValidator.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">src_las_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_las_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">las_metadata</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><span class="pre">dict</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><span class="pre">dict</span></a></span></span><a class="reference internal" href="../_modules/lidar_prod/tasks/building_validation.html#BuildingValidator.update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lidar_prod.tasks.building_validation.BuildingValidator.update" title="Link to this definition"></a></dt>
<dd><p>Updates point cloud classification channel.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="lidar_prod.tasks.building_validation.thresholds">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">lidar_prod.tasks.building_validation.</span></span><span class="sig-name descname"><span class="pre">thresholds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">min_confidence_confirmation</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_frac_confirmation</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_frac_confirmation_factor_if_bd_uni_overlay</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_uni_db_overlay_frac</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_confidence_refutation</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_frac_refutation</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_entropy_uncertainty</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_frac_entropy_uncertain</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/lidar_prod/tasks/building_validation.html#thresholds"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lidar_prod.tasks.building_validation.thresholds" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>The decision thresholds for a cluser-level decisions.</p>
<dl class="py method">
<dt class="sig sig-object py" id="lidar_prod.tasks.building_validation.thresholds.dump">
<span class="sig-name descname"><span class="pre">dump</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/lidar_prod/tasks/building_validation.html#thresholds.dump"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lidar_prod.tasks.building_validation.thresholds.dump" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lidar_prod.tasks.building_validation.thresholds.load">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/lidar_prod/tasks/building_validation.html#thresholds.load"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lidar_prod.tasks.building_validation.thresholds.load" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lidar_prod.tasks.building_validation.thresholds.min_confidence_confirmation">
<span class="sig-name descname"><span class="pre">min_confidence_confirmation</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a></em><a class="headerlink" href="#lidar_prod.tasks.building_validation.thresholds.min_confidence_confirmation" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lidar_prod.tasks.building_validation.thresholds.min_confidence_refutation">
<span class="sig-name descname"><span class="pre">min_confidence_refutation</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a></em><a class="headerlink" href="#lidar_prod.tasks.building_validation.thresholds.min_confidence_refutation" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lidar_prod.tasks.building_validation.thresholds.min_entropy_uncertainty">
<span class="sig-name descname"><span class="pre">min_entropy_uncertainty</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a></em><a class="headerlink" href="#lidar_prod.tasks.building_validation.thresholds.min_entropy_uncertainty" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lidar_prod.tasks.building_validation.thresholds.min_frac_confirmation">
<span class="sig-name descname"><span class="pre">min_frac_confirmation</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a></em><a class="headerlink" href="#lidar_prod.tasks.building_validation.thresholds.min_frac_confirmation" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lidar_prod.tasks.building_validation.thresholds.min_frac_confirmation_factor_if_bd_uni_overlay">
<span class="sig-name descname"><span class="pre">min_frac_confirmation_factor_if_bd_uni_overlay</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a></em><a class="headerlink" href="#lidar_prod.tasks.building_validation.thresholds.min_frac_confirmation_factor_if_bd_uni_overlay" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lidar_prod.tasks.building_validation.thresholds.min_frac_entropy_uncertain">
<span class="sig-name descname"><span class="pre">min_frac_entropy_uncertain</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a></em><a class="headerlink" href="#lidar_prod.tasks.building_validation.thresholds.min_frac_entropy_uncertain" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lidar_prod.tasks.building_validation.thresholds.min_frac_refutation">
<span class="sig-name descname"><span class="pre">min_frac_refutation</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a></em><a class="headerlink" href="#lidar_prod.tasks.building_validation.thresholds.min_frac_refutation" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lidar_prod.tasks.building_validation.thresholds.min_uni_db_overlay_frac">
<span class="sig-name descname"><span class="pre">min_uni_db_overlay_frac</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a></em><a class="headerlink" href="#lidar_prod.tasks.building_validation.thresholds.min_uni_db_overlay_frac" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-lidar_prod.tasks.building_validation_optimization">
<span id="building-validation-optimization"></span><h2>building_validation_optimization<a class="headerlink" href="#module-lidar_prod.tasks.building_validation_optimization" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="lidar_prod.tasks.building_validation_optimization.BuildingValidationOptimizer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">lidar_prod.tasks.building_validation_optimization.</span></span><span class="sig-name descname"><span class="pre">BuildingValidationOptimizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">todo</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">paths</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.12)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">building_validator</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#lidar_prod.tasks.building_validation.BuildingValidator" title="lidar_prod.tasks.building_validation.BuildingValidator"><span class="pre">BuildingValidator</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">study</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Study</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">design</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.12)"><span class="pre">Any</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">buildings_correction_labels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.12)"><span class="pre">Any</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_final_classification_codes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">debug</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/lidar_prod/tasks/building_validation_optimization.html#BuildingValidationOptimizer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lidar_prod.tasks.building_validation_optimization.BuildingValidationOptimizer" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Optimizer of the decision thresholds used by <cite>BuildingValidator</cite>.</p>
<p>In lidar-prod, each task is implemented by a dedicated python class.
Building Validation is implemented via a <code class="xref py py-class docutils literal notranslate"><span class="pre">BuildingValidator</span></code> class.
We make sure that all parameters used for optimization are the one we
actually use in production.</p>
<p>For a higher internal cohesion, <cite>BuildingValidator</cite> does not know
anything about optimization, which is taken care of by a
<cite>BuildingValidationOptimizer</cite> python class.
Two dataclasses are used to connect the two objects.
<cite>BuildingValidationClusterInfo</cite> describes the cluster-level information,
necessary to perform a validation.
<cite>thresholds</cite> describes the different thresholds used
in <cite>BuildingValidator</cite> and optimized in <cite>BuildingValidationOptimizer</cite>.</p>
<p>In Building Validation, the most time-consuming step is the preparation
of data, including the clustering of candidate building points and the
overlay of vectors of buildings from a public databse:
up to several minutes per km² of data.
The <cite>BuildingValidationOptimizer</cite> breaks down the Building Validation steps to make
sure that data preparation only occurs onces.
All outputs and intermediary files are stored in a <cite>results_output_dir</cite>
directory, so that operations may be resumed at any steps, for instance
to rerun a thresholds optimization with a different optimizer configuration.</p>
<dl class="py method">
<dt class="sig sig-object py" id="lidar_prod.tasks.building_validation_optimization.BuildingValidationOptimizer.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><span class="pre">dict</span></a></span></span><a class="reference internal" href="../_modules/lidar_prod/tasks/building_validation_optimization.html#BuildingValidationOptimizer.evaluate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lidar_prod.tasks.building_validation_optimization.BuildingValidationOptimizer.evaluate" title="Link to this definition"></a></dt>
<dd><p>Evaluation step.</p>
<p>Deserializes the set of optimal thresholds.
Deserializes the clusters informations.
Computes the Recall, Precision, and Automation of the <cite>BuildingValidator</cite>
on the clusters using optimal thresholds, as well as other metrics
including confusion matrices.
If a validation dataset was used for optimization, this evaluation
may be ran on a test dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>a dictionnary of metrics of schema {metric_name:metric_value}.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)">dict</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lidar_prod.tasks.building_validation_optimization.BuildingValidationOptimizer.evaluate_decisions">
<span class="sig-name descname"><span class="pre">evaluate_decisions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mts_gt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ia_decision</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.12)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.12)"><span class="pre">Any</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/lidar_prod/tasks/building_validation_optimization.html#BuildingValidationOptimizer.evaluate_decisions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lidar_prod.tasks.building_validation_optimization.BuildingValidationOptimizer.evaluate_decisions" title="Link to this definition"></a></dt>
<dd><p>Evaluate confirmation and refutation decisions.</p>
<p>Get dict of metrics to evaluate how good module decisions were in reference to
ground truths.</p>
<p>Targets: U=Unsure, N=No (not a building), Y=Yes (building)</p>
<p>Predictions : U=Unsure, C=Confirmation, R=Refutation</p>
<p>Confusion Matrix (horizontal: target, vertical: predictions)</p>
<p>[Uu Ur Uc]</p>
<p>[Nu Nr Nc]</p>
<p>[Yu Yr Yc]</p>
<p>Automation: Proportion of each decision among total of candidate groups.</p>
<p>Accuracies:
Confirmation/Refutation Accuracy.
Accurate decision if either “unsure” or the same as the label.</p>
<p>Quality
Precision and Recall, assuming perfect posterior decision for unsure predictions.
Only candidate shapes with known ground truths are considered
(ambiguous labels are ignored).</p>
<p>Precision : (Yu + Yc) / (Yu + Yc + Nc)</p>
<p>Recall : (Yu + Yc) / (Yu + Yn + Yc)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><span class="target" id="lidar_prod.tasks.building_validation_optimization.BuildingValidationOptimizer.evaluate_decisions.params.mts_gt"></span><strong>mts_gt</strong><a class="paramlink headerlink reference internal" href="#lidar_prod.tasks.building_validation_optimization.BuildingValidationOptimizer.evaluate_decisions.params.mts_gt">¶</a> (<em>np.array</em>) – ground truth of rule- based classification (0, 1, 2)</p></li>
<li><p><span class="target" id="lidar_prod.tasks.building_validation_optimization.BuildingValidationOptimizer.evaluate_decisions.params.ia_decision"></span><strong>ia_decision</strong><a class="paramlink headerlink reference internal" href="#lidar_prod.tasks.building_validation_optimization.BuildingValidationOptimizer.evaluate_decisions.params.ia_decision">¶</a> (<em>np.array</em>) – AI application decision (0, 1, 2)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>dictionnary of metrics.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)">dict</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lidar_prod.tasks.building_validation_optimization.BuildingValidationOptimizer.optimize">
<span class="sig-name descname"><span class="pre">optimize</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/lidar_prod/tasks/building_validation_optimization.html#BuildingValidationOptimizer.optimize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lidar_prod.tasks.building_validation_optimization.BuildingValidationOptimizer.optimize" title="Link to this definition"></a></dt>
<dd><p>Optimization step.</p>
<p>Deserializes the clusters informations.
Runs the genetic algorithm for N generations.
For each set of decision thresholds, computes the Recall, Precision,
and Automation of the <cite>BuildingValidator</cite>.
Finally, serializes the set of optimal thresholds.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lidar_prod.tasks.building_validation_optimization.BuildingValidationOptimizer.prepare">
<span class="sig-name descname"><span class="pre">prepare</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/lidar_prod/tasks/building_validation_optimization.html#BuildingValidationOptimizer.prepare"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lidar_prod.tasks.building_validation_optimization.BuildingValidationOptimizer.prepare" title="Link to this definition"></a></dt>
<dd><p>Preparation step.</p>
<p>Prepares and saves each point cloud in the specified directory,
and extracts all cluster information in a list of
<cite>BuildingValidationClusterInfo</cite> objects that is serialized into
a pickle object.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lidar_prod.tasks.building_validation_optimization.BuildingValidationOptimizer.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/lidar_prod/tasks/building_validation_optimization.html#BuildingValidationOptimizer.run"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lidar_prod.tasks.building_validation_optimization.BuildingValidationOptimizer.run" title="Link to this definition"></a></dt>
<dd><p>Run decision threshold optimization.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lidar_prod.tasks.building_validation_optimization.BuildingValidationOptimizer.save_config_with_optimized_thresolds">
<span class="sig-name descname"><span class="pre">save_config_with_optimized_thresolds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DictConfig</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/lidar_prod/tasks/building_validation_optimization.html#BuildingValidationOptimizer.save_config_with_optimized_thresolds"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lidar_prod.tasks.building_validation_optimization.BuildingValidationOptimizer.save_config_with_optimized_thresolds" title="Link to this definition"></a></dt>
<dd><p>Save config the thresholds in the building_validation.application
part replaced by optimized thresholds</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lidar_prod.tasks.building_validation_optimization.BuildingValidationOptimizer.setup">
<span class="sig-name descname"><span class="pre">setup</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/lidar_prod/tasks/building_validation_optimization.html#BuildingValidationOptimizer.setup"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lidar_prod.tasks.building_validation_optimization.BuildingValidationOptimizer.setup" title="Link to this definition"></a></dt>
<dd><p>Setup step.</p>
<p>Setup a few attributes and override BuildingValidator classification
codes to adapt to those of the optimization dataset.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lidar_prod.tasks.building_validation_optimization.BuildingValidationOptimizer.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/lidar_prod/tasks/building_validation_optimization.html#BuildingValidationOptimizer.update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lidar_prod.tasks.building_validation_optimization.BuildingValidationOptimizer.update" title="Link to this definition"></a></dt>
<dd><p>Update step.</p>
<p>Deserializes the set of optimal thresholds.
<cite>BuildingValidator</cite> updates each prepared point cloud classification
based on those threshods and saves the result.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="lidar_prod.tasks.building_validation_optimization.constraints_func">
<span class="sig-prename descclassname"><span class="pre">lidar_prod.tasks.building_validation_optimization.</span></span><span class="sig-name descname"><span class="pre">constraints_func</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trial</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/lidar_prod/tasks/building_validation_optimization.html#constraints_func"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lidar_prod.tasks.building_validation_optimization.constraints_func" title="Link to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-lidar_prod.tasks.building_completion">
<span id="building-completion"></span><h2>building_completion<a class="headerlink" href="#module-lidar_prod.tasks.building_completion" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="lidar_prod.tasks.building_completion.BuildingCompletor">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">lidar_prod.tasks.building_completion.</span></span><span class="sig-name descname"><span class="pre">BuildingCompletor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">min_building_proba</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cluster</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/lidar_prod/tasks/building_completion.html#BuildingCompletor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lidar_prod.tasks.building_completion.BuildingCompletor" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Logic of building completion.</p>
<p>The BuildingValidator only considered points that were 1) candidate, and 2) formed clusters
of sufficient size.</p>
<p>Some points were too isolated, or where not clustered, even though they might have a
high predicted building probabiliy.
We assume that we can trust AI probabilities (if high enough) in the neigborhood
of large groups (clusters) of candidate points already confirmed by the BuildingValidator.</p>
<p>We will update points classification based on their probability as well as their surrounding:
- We select points that have p&gt;=0.5 (+ a BDUni factor when applicable)
- We perform vertical (XY) clustering of A) these points, together with B) confirmed buildings.
- If the resulting clusters contain confirmed buildings, points with high probability are
considered to be part of the confirmed building and their class is updated accordingly.</p>
<dl class="py method">
<dt class="sig sig-object py" id="lidar_prod.tasks.building_completion.BuildingCompletor.prepare_for_building_completion">
<span class="sig-name descname"><span class="pre">prepare_for_building_completion</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pipeline</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Pipeline</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../_modules/lidar_prod/tasks/building_completion.html#BuildingCompletor.prepare_for_building_completion"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lidar_prod.tasks.building_completion.BuildingCompletor.prepare_for_building_completion" title="Link to this definition"></a></dt>
<dd><p>Prepare for building completion.</p>
<p>Identify candidates that have high enough probability. Then, cluster them together with
previously confirmed buildings.
Cluster parameters are relaxed (2D, with high tolerance).
If a cluster contains some confirmed points, the others are considered to belong to
the same building and they will be confirmed as well.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="target" id="lidar_prod.tasks.building_completion.BuildingCompletor.prepare_for_building_completion.params.pipeline"></span><strong>pipeline</strong><a class="paramlink headerlink reference internal" href="#lidar_prod.tasks.building_completion.BuildingCompletor.prepare_for_building_completion.params.pipeline">¶</a> (<em>pdal.pipeline.Pipeline</em>) – input LAS pipeline</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lidar_prod.tasks.building_completion.BuildingCompletor.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_values</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Pipeline</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">las_metadata</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><span class="pre">dict</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><span class="pre">dict</span></a></span></span><a class="reference internal" href="../_modules/lidar_prod/tasks/building_completion.html#BuildingCompletor.run"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lidar_prod.tasks.building_completion.BuildingCompletor.run" title="Link to this definition"></a></dt>
<dd><p>Application.</p>
<p>Transform cloud at <cite>src_las_path</cite> following building completion logic</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><span class="target" id="lidar_prod.tasks.building_completion.BuildingCompletor.run.params.input_values"></span><strong>input_values</strong><a class="paramlink headerlink reference internal" href="#lidar_prod.tasks.building_completion.BuildingCompletor.run.params.input_values">¶</a> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em>|</em><em>pdal.pipeline.Pipeline</em>) – path to either input LAS file or a pipeline</p></li>
<li><p><span class="target" id="lidar_prod.tasks.building_completion.BuildingCompletor.run.params.target_las_path"></span><strong>target_las_path</strong><a class="paramlink headerlink reference internal" href="#lidar_prod.tasks.building_completion.BuildingCompletor.run.params.target_las_path">¶</a> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – path for saving updated LAS file.</p></li>
<li><p><span class="target" id="lidar_prod.tasks.building_completion.BuildingCompletor.run.params.las_metadata"></span><strong>las_metadata</strong><a class="paramlink headerlink reference internal" href="#lidar_prod.tasks.building_completion.BuildingCompletor.run.params.las_metadata">¶</a> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><em>dict</em></a>) – current pipeline metadata, used to propagate input metadata to the</p></li>
</ul>
</dd>
</dl>
<p>application output las (epsg, las version, etc)</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>returns <cite>las_metadata</cite>: metadata of the initial las, which contain
information to pass to the writer in order for the application to have an output
with the same header (las version, srs, …) as the input</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lidar_prod.tasks.building_completion.BuildingCompletor.update_classification">
<span class="sig-name descname"><span class="pre">update_classification</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../_modules/lidar_prod/tasks/building_completion.html#BuildingCompletor.update_classification"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lidar_prod.tasks.building_completion.BuildingCompletor.update_classification" title="Link to this definition"></a></dt>
<dd><p>Update Classification dimension by completing buildings with high probability points.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-lidar_prod.tasks.building_identification">
<span id="building-identification"></span><h2>building_identification<a class="headerlink" href="#module-lidar_prod.tasks.building_identification" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="lidar_prod.tasks.building_identification.BuildingIdentifier">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">lidar_prod.tasks.building_identification.</span></span><span class="sig-name descname"><span class="pre">BuildingIdentifier</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">min_building_proba</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cluster</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/lidar_prod/tasks/building_identification.html#BuildingIdentifier"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lidar_prod.tasks.building_identification.BuildingIdentifier" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Logic of building validation.</p>
<p>Points that were not found by rule-based algorithms but which have a high-enough probability of
being a building are clustered into candidate groups of buildings.</p>
<p>High enough probability means p&gt;=min_building_proba</p>
<dl class="py method">
<dt class="sig sig-object py" id="lidar_prod.tasks.building_identification.BuildingIdentifier.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_values</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Pipeline</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_las_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">las_metadata</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><span class="pre">dict</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><span class="pre">dict</span></a></span></span><a class="reference internal" href="../_modules/lidar_prod/tasks/building_identification.html#BuildingIdentifier.run"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lidar_prod.tasks.building_identification.BuildingIdentifier.run" title="Link to this definition"></a></dt>
<dd><p>Identify potential buildings in a new channel, excluding former candidates as well as
already confirmed building (confirmed by either Validation or Completion).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><span class="target" id="lidar_prod.tasks.building_identification.BuildingIdentifier.run.params.input_values"></span><strong>input_values</strong><a class="paramlink headerlink reference internal" href="#lidar_prod.tasks.building_identification.BuildingIdentifier.run.params.input_values">¶</a> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em> | </em><em>pdal.pipeline.Pipeline</em>) – path or pipeline to input LAS file with</p></li>
<li><p><strong>channel</strong> (<em>a _sphinx_paramlinks_lidar_prod.tasks.building_identification.BuildingIdentifier.run.building probability</em>) – </p></li>
<li><p><span class="target" id="lidar_prod.tasks.building_identification.BuildingIdentifier.run.params.target_las_path"></span><strong>target_las_path</strong><a class="paramlink headerlink reference internal" href="#lidar_prod.tasks.building_identification.BuildingIdentifier.run.params.target_las_path">¶</a> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – output LAS</p></li>
<li><p><span class="target" id="lidar_prod.tasks.building_identification.BuildingIdentifier.run.params.las_metadata"></span><strong>las_metadata</strong><a class="paramlink headerlink reference internal" href="#lidar_prod.tasks.building_identification.BuildingIdentifier.run.params.las_metadata">¶</a> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><em>dict</em></a>) – current pipeline metadata, used to propagate input metadata to the</p></li>
</ul>
</dd>
</dl>
<p>application output las (epsg, las version, etc)</p>
<p>Returns: updated las_metadata</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-lidar_prod.tasks.cleaning">
<span id="cleaning"></span><h2>cleaning<a class="headerlink" href="#module-lidar_prod.tasks.cleaning" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="lidar_prod.tasks.cleaning.Cleaner">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">lidar_prod.tasks.cleaning.</span></span><span class="sig-name descname"><span class="pre">Cleaner</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">extra_dims</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Iterable" title="(in Python v3.12)"><span class="pre">Iterable</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/lidar_prod/tasks/cleaning.html#Cleaner"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lidar_prod.tasks.cleaning.Cleaner" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Keep only necessary extra dimensions channels.</p>
<dl class="py method">
<dt class="sig sig-object py" id="lidar_prod.tasks.cleaning.Cleaner.add_dimensions">
<span class="sig-name descname"><span class="pre">add_dimensions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">las_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">LasData</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/lidar_prod/tasks/cleaning.html#Cleaner.add_dimensions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lidar_prod.tasks.cleaning.Cleaner.add_dimensions" title="Link to this definition"></a></dt>
<dd><p>Add the dimensions that exist in self.extra_dimensions but not in las data</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lidar_prod.tasks.cleaning.Cleaner.get_extra_dims_as_str">
<span class="sig-name descname"><span class="pre">get_extra_dims_as_str</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/lidar_prod/tasks/cleaning.html#Cleaner.get_extra_dims_as_str"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lidar_prod.tasks.cleaning.Cleaner.get_extra_dims_as_str" title="Link to this definition"></a></dt>
<dd><p>‘stringify’ the extra_dims list and return it, or an empty list if there is
no extra dims</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lidar_prod.tasks.cleaning.Cleaner.remove_dimensions">
<span class="sig-name descname"><span class="pre">remove_dimensions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">las_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">LasData</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/lidar_prod/tasks/cleaning.html#Cleaner.remove_dimensions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lidar_prod.tasks.cleaning.Cleaner.remove_dimensions" title="Link to this definition"></a></dt>
<dd><p>remove dimension from (laspy) data</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lidar_prod.tasks.cleaning.Cleaner.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">src_las_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_las_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/lidar_prod/tasks/cleaning.html#Cleaner.run"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lidar_prod.tasks.cleaning.Cleaner.run" title="Link to this definition"></a></dt>
<dd><p>Clean out LAS extra dimensions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><span class="target" id="lidar_prod.tasks.cleaning.Cleaner.run.params.src_las_path"></span><strong>src_las_path</strong><a class="paramlink headerlink reference internal" href="#lidar_prod.tasks.cleaning.Cleaner.run.params.src_las_path">¶</a> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – input LAS path</p></li>
<li><p><span class="target" id="lidar_prod.tasks.cleaning.Cleaner.run.params.target_las_path"></span><strong>target_las_path</strong><a class="paramlink headerlink reference internal" href="#lidar_prod.tasks.cleaning.Cleaner.run.params.target_las_path">¶</a> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – output LAS path, with specified extra dims.</p></li>
<li><p><span class="target" id="lidar_prod.tasks.cleaning.Cleaner.run.params.epsg"></span><strong>epsg</strong><a class="paramlink headerlink reference internal" href="#lidar_prod.tasks.cleaning.Cleaner.run.params.epsg">¶</a> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – epsg code for the input file (if empty or None: infer</p></li>
</ul>
</dd>
</dl>
<p>it from the las metadata)</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-lidar_prod.tasks.utils">
<span id="utils"></span><h2>utils<a class="headerlink" href="#module-lidar_prod.tasks.utils" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="lidar_prod.tasks.utils.BDUniConnectionParams">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">lidar_prod.tasks.utils.</span></span><span class="sig-name descname"><span class="pre">BDUniConnectionParams</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">host</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">user</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">pwd</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">bd_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/lidar_prod/tasks/utils.html#BDUniConnectionParams"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lidar_prod.tasks.utils.BDUniConnectionParams" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>URL and public credentials to connect to a database - typically the BDUni</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="lidar_prod.tasks.utils.BDUniConnectionParams.bd_name">
<span class="sig-name descname"><span class="pre">bd_name</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></em><a class="headerlink" href="#lidar_prod.tasks.utils.BDUniConnectionParams.bd_name" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lidar_prod.tasks.utils.BDUniConnectionParams.host">
<span class="sig-name descname"><span class="pre">host</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></em><a class="headerlink" href="#lidar_prod.tasks.utils.BDUniConnectionParams.host" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lidar_prod.tasks.utils.BDUniConnectionParams.pwd">
<span class="sig-name descname"><span class="pre">pwd</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></em><a class="headerlink" href="#lidar_prod.tasks.utils.BDUniConnectionParams.pwd" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lidar_prod.tasks.utils.BDUniConnectionParams.user">
<span class="sig-name descname"><span class="pre">user</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></em><a class="headerlink" href="#lidar_prod.tasks.utils.BDUniConnectionParams.user" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="lidar_prod.tasks.utils.check_bbox_intersects_territoire_with_srid">
<span class="sig-prename descclassname"><span class="pre">lidar_prod.tasks.utils.</span></span><span class="sig-name descname"><span class="pre">check_bbox_intersects_territoire_with_srid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bd_params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#lidar_prod.tasks.utils.BDUniConnectionParams" title="lidar_prod.tasks.utils.BDUniConnectionParams"><span class="pre">BDUniConnectionParams</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">bbox</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.12)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsg_srid</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/lidar_prod/tasks/utils.html#check_bbox_intersects_territoire_with_srid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lidar_prod.tasks.utils.check_bbox_intersects_territoire_with_srid" title="Link to this definition"></a></dt>
<dd><p>Check if a bounding box intersects one of the territories from the BDUni database
(public.gcms_territoire) with the expected srid.
As geometries are indicated with srid = 0 in the database (but stored in their original
projection),
both geometries are compared using this common srid.
In the territoire geometry query, ST_Union is used to combine different territoires that
would have the same
srid (eg. 5490 for Guadeloupe and Martinique)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="lidar_prod.tasks.utils.get_a_las_to_las_pdal_pipeline">
<span class="sig-prename descclassname"><span class="pre">lidar_prod.tasks.utils.</span></span><span class="sig-name descname"><span class="pre">get_a_las_to_las_pdal_pipeline</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">src_las_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_las_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">ops</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Iterable" title="(in Python v3.12)"><span class="pre">Iterable</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.12)"><span class="pre">Any</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/lidar_prod/tasks/utils.html#get_a_las_to_las_pdal_pipeline"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lidar_prod.tasks.utils.get_a_las_to_las_pdal_pipeline" title="Link to this definition"></a></dt>
<dd><p>Create a pdal pipeline, preserving format, forwarding every dimension.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><span class="target" id="lidar_prod.tasks.utils.get_a_las_to_las_pdal_pipeline.params.src_las_path"></span><strong>src_las_path</strong><a class="paramlink headerlink reference internal" href="#lidar_prod.tasks.utils.get_a_las_to_las_pdal_pipeline.params.src_las_path">¶</a> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – input LAS path</p></li>
<li><p><span class="target" id="lidar_prod.tasks.utils.get_a_las_to_las_pdal_pipeline.params.target_las_path"></span><strong>target_las_path</strong><a class="paramlink headerlink reference internal" href="#lidar_prod.tasks.utils.get_a_las_to_las_pdal_pipeline.params.target_las_path">¶</a> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – output LAS path</p></li>
<li><p><span class="target" id="lidar_prod.tasks.utils.get_a_las_to_las_pdal_pipeline.params.ops"></span><strong>ops</strong><a class="paramlink headerlink reference internal" href="#lidar_prod.tasks.utils.get_a_las_to_las_pdal_pipeline.params.ops">¶</a> (<em>Iterable</em><em>[</em><em>Any</em><em>]</em>) – list of pdal operation (e.g. Filter.assign(…))</p></li>
<li><p><span class="target" id="lidar_prod.tasks.utils.get_a_las_to_las_pdal_pipeline.params.epsg"></span><strong>epsg</strong><a class="paramlink headerlink reference internal" href="#lidar_prod.tasks.utils.get_a_las_to_las_pdal_pipeline.params.epsg">¶</a> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – epsg code for the input file (if empty or None: infer it from the</p></li>
<li><p><span class="target" id="lidar_prod.tasks.utils.get_a_las_to_las_pdal_pipeline.params.metadata"></span><strong>metadata</strong><a class="paramlink headerlink reference internal" href="#lidar_prod.tasks.utils.get_a_las_to_las_pdal_pipeline.params.metadata">¶</a><strong>)</strong> (<em>las</em>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="lidar_prod.tasks.utils.get_input_las_metadata">
<span class="sig-prename descclassname"><span class="pre">lidar_prod.tasks.utils.</span></span><span class="sig-name descname"><span class="pre">get_input_las_metadata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pipeline</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Pipeline</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/lidar_prod/tasks/utils.html#get_input_las_metadata"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lidar_prod.tasks.utils.get_input_las_metadata" title="Link to this definition"></a></dt>
<dd><p>Get las reader metadata from the input pipeline</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="lidar_prod.tasks.utils.get_integer_bbox">
<span class="sig-prename descclassname"><span class="pre">lidar_prod.tasks.utils.</span></span><span class="sig-name descname"><span class="pre">get_integer_bbox</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pipeline</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Pipeline</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">buffer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Number" title="(in Python v3.12)"><span class="pre">Number</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.12)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/lidar_prod/tasks/utils.html#get_integer_bbox"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lidar_prod.tasks.utils.get_integer_bbox" title="Link to this definition"></a></dt>
<dd><p>Get XY bounding box of the las input of a pipeline, cast x/y min/max to integers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><span class="target" id="lidar_prod.tasks.utils.get_integer_bbox.params.pipeline"></span><strong>pipeline</strong><a class="paramlink headerlink reference internal" href="#lidar_prod.tasks.utils.get_integer_bbox.params.pipeline">¶</a> (<em>pdal.pipeline.Pipeline</em>) – pipeline for which to read the input bounding box</p></li>
<li><p><span class="target" id="lidar_prod.tasks.utils.get_integer_bbox.params.buffer"></span><strong>buffer</strong><a class="paramlink headerlink reference internal" href="#lidar_prod.tasks.utils.get_integer_bbox.params.buffer">¶</a> (<em>Number</em><em>, </em><em>optional</em>) – buffer to add to the bounds before casting it to integers.</p></li>
<li><p><strong>0.</strong> (<em>Defaults _sphinx_paramlinks_lidar_prod.tasks.utils.get_integer_bbox.to</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>x/y min/max values as a dictionary</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)">str</a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)">int</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="lidar_prod.tasks.utils.get_las_data_from_las">
<span class="sig-prename descclassname"><span class="pre">lidar_prod.tasks.utils.</span></span><span class="sig-name descname"><span class="pre">get_las_data_from_las</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">las_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">LasData</span></span></span><a class="reference internal" href="../_modules/lidar_prod/tasks/utils.html#get_las_data_from_las"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lidar_prod.tasks.utils.get_las_data_from_las" title="Link to this definition"></a></dt>
<dd><p>Load las data from a las file</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="lidar_prod.tasks.utils.get_pdal_reader">
<span class="sig-prename descclassname"><span class="pre">lidar_prod.tasks.utils.</span></span><span class="sig-name descname"><span class="pre">get_pdal_reader</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">las_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">las</span></span></span><a class="reference internal" href="../_modules/lidar_prod/tasks/utils.html#get_pdal_reader"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lidar_prod.tasks.utils.get_pdal_reader" title="Link to this definition"></a></dt>
<dd><p>Standard Reader which imposes Lamber 93 SRS.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><span class="target" id="lidar_prod.tasks.utils.get_pdal_reader.params.las_path"></span><strong>las_path</strong><a class="paramlink headerlink reference internal" href="#lidar_prod.tasks.utils.get_pdal_reader.params.las_path">¶</a> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – input LAS path to read.</p></li>
<li><p><span class="target" id="lidar_prod.tasks.utils.get_pdal_reader.params.epsg"></span><strong>epsg</strong><a class="paramlink headerlink reference internal" href="#lidar_prod.tasks.utils.get_pdal_reader.params.epsg">¶</a> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – epsg code for the input file (if empty or None: infer</p></li>
<li><p><strong>metadata</strong><strong>)</strong> (<em>it _sphinx_paramlinks_lidar_prod.tasks.utils.get_pdal_reader.from the las</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>reader to use in a pipeline.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pdal.Reader.las</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="lidar_prod.tasks.utils.get_pdal_writer">
<span class="sig-prename descclassname"><span class="pre">lidar_prod.tasks.utils.</span></span><span class="sig-name descname"><span class="pre">get_pdal_writer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target_las_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">reader_metadata</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra_dims</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'all'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">las</span></span></span><a class="reference internal" href="../_modules/lidar_prod/tasks/utils.html#get_pdal_writer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lidar_prod.tasks.utils.get_pdal_writer" title="Link to this definition"></a></dt>
<dd><p>Standard LAS Writer which imposes LAS 1.4 specification and dataformat 8.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><span class="target" id="lidar_prod.tasks.utils.get_pdal_writer.params.target_las_path"></span><strong>target_las_path</strong><a class="paramlink headerlink reference internal" href="#lidar_prod.tasks.utils.get_pdal_writer.params.target_las_path">¶</a> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – output LAS path to write.</p></li>
<li><p><span class="target" id="lidar_prod.tasks.utils.get_pdal_writer.params.extra_dims"></span><strong>extra_dims</strong><a class="paramlink headerlink reference internal" href="#lidar_prod.tasks.utils.get_pdal_writer.params.extra_dims">¶</a> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – extra dimensions to keep, in the format expected by pdal.Writer.las.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>writer to use in a pipeline.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pdal.Writer.las</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="lidar_prod.tasks.utils.get_pipeline">
<span class="sig-prename descclassname"><span class="pre">lidar_prod.tasks.utils.</span></span><span class="sig-name descname"><span class="pre">get_pipeline</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Pipeline</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">las_metadata</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><span class="pre">dict</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/lidar_prod/tasks/utils.html#get_pipeline"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lidar_prod.tasks.utils.get_pipeline" title="Link to this definition"></a></dt>
<dd><p>If the input value is a pipeline, returns it, if it’s a las path return the corresponding
pipeline,
If the input is a las_path, pipeline_metadata is updated to the new pipeline metadata</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><span class="target" id="lidar_prod.tasks.utils.get_pipeline.params.input_value"></span><strong>input_value</strong><a class="paramlink headerlink reference internal" href="#lidar_prod.tasks.utils.get_pipeline.params.input_value">¶</a> (<em>pdal.pipeline.Pipeline</em><em> | </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – input value to get a pipeline from</p></li>
<li><p><strong>pdal</strong><strong>)</strong> (<em>(</em><em>las _sphinx_paramlinks_lidar_prod.tasks.utils.get_pipeline.pipeline</em><em> or </em><em>path to a file to read with</em>) – </p></li>
<li><p><span class="target" id="lidar_prod.tasks.utils.get_pipeline.params.epsg"></span><strong>epsg</strong><a class="paramlink headerlink reference internal" href="#lidar_prod.tasks.utils.get_pipeline.params.epsg">¶</a> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – if input_value is a string, use the epsg value to override the crs from</p></li>
<li><p><strong>header</strong> (<em>the _sphinx_paramlinks_lidar_prod.tasks.utils.get_pipeline.las</em>) – </p></li>
<li><p><span class="target" id="lidar_prod.tasks.utils.get_pipeline.params.las_metadata"></span><strong>las_metadata</strong><a class="paramlink headerlink reference internal" href="#lidar_prod.tasks.utils.get_pipeline.params.las_metadata">¶</a> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><em>dict</em></a>) – current pipeline metadata, used to propagate input metadata to the</p></li>
<li><p><strong>las</strong> (<em>application _sphinx_paramlinks_lidar_prod.tasks.utils.get_pipeline.output</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>pdal pipeline, updated pipeline_metadata dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="lidar_prod.tasks.utils.pdal_read_las_array">
<span class="sig-prename descclassname"><span class="pre">lidar_prod.tasks.utils.</span></span><span class="sig-name descname"><span class="pre">pdal_read_las_array</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">las_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/lidar_prod/tasks/utils.html#pdal_read_las_array"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lidar_prod.tasks.utils.pdal_read_las_array" title="Link to this definition"></a></dt>
<dd><p>Read LAS as a named array.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><span class="target" id="lidar_prod.tasks.utils.pdal_read_las_array.params.las_path"></span><strong>las_path</strong><a class="paramlink headerlink reference internal" href="#lidar_prod.tasks.utils.pdal_read_las_array.params.las_path">¶</a> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – input LAS path</p></li>
<li><p><span class="target" id="lidar_prod.tasks.utils.pdal_read_las_array.params.epsg"></span><strong>epsg</strong><a class="paramlink headerlink reference internal" href="#lidar_prod.tasks.utils.pdal_read_las_array.params.epsg">¶</a> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – epsg code for the input file (if empty or None: infer it from the</p></li>
<li><p><span class="target" id="lidar_prod.tasks.utils.pdal_read_las_array.params.metadata"></span><strong>metadata</strong><a class="paramlink headerlink reference internal" href="#lidar_prod.tasks.utils.pdal_read_las_array.params.metadata">¶</a><strong>)</strong> (<em>las</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>named array with all LAS dimensions, including extra ones, with dict-like
access.
las_metadata dict</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="lidar_prod.tasks.utils.request_bd_uni_for_building_shapefile">
<span class="sig-prename descclassname"><span class="pre">lidar_prod.tasks.utils.</span></span><span class="sig-name descname"><span class="pre">request_bd_uni_for_building_shapefile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bd_params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#lidar_prod.tasks.utils.BDUniConnectionParams" title="lidar_prod.tasks.utils.BDUniConnectionParams"><span class="pre">BDUniConnectionParams</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">shapefile_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">bbox</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.12)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/lidar_prod/tasks/utils.html#request_bd_uni_for_building_shapefile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lidar_prod.tasks.utils.request_bd_uni_for_building_shapefile" title="Link to this definition"></a></dt>
<dd><p>Request BD Uni for its buildings.</p>
<p>Create a shapefile with non destructed building on the area of interest and saves it.</p>
<p>Also add a “PRESENCE” column filled with 1 for later use by pdal.</p>
<p>Note on the projections:
Projections are mixed in the BDUni tables.
In PostGIS, the declared projection is 0 but the data are stored in the legal projection of
the corresponding territories.
In each table, there is a a “gcms_territoire” field, which tells the corresponding territory
(3 letters code).
The gcms_territoire table gives hints on each territory (SRID, footprint)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="lidar_prod.tasks.utils.save_las_data_to_las">
<span class="sig-prename descclassname"><span class="pre">lidar_prod.tasks.utils.</span></span><span class="sig-name descname"><span class="pre">save_las_data_to_las</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">las_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">las_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">LasData</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/lidar_prod/tasks/utils.html#save_las_data_to_las"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lidar_prod.tasks.utils.save_las_data_to_las" title="Link to this definition"></a></dt>
<dd><p>save las data to a las file</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="lidar_prod.tasks.utils.split_idx_by_dim">
<span class="sig-prename descclassname"><span class="pre">lidar_prod.tasks.utils.</span></span><span class="sig-name descname"><span class="pre">split_idx_by_dim</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim_array</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/lidar_prod/tasks/utils.html#split_idx_by_dim"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lidar_prod.tasks.utils.split_idx_by_dim" title="Link to this definition"></a></dt>
<dd><p>Returns a sequence of arrays of indices of elements sharing the same value in dim_array
Groups are ordered by ascending value.</p>
</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="lidar_prod.html" class="btn btn-neutral float-left" title="lidar_prod.run" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="lidar_prod.commons.html" class="btn btn-neutral float-right" title="lidar_prod.commons" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Institut National de l&#39;Information Géographique et Forestière.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>